<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LAN Game Vote</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body class="bg-gray-50">
    <div class="container mx-auto px-4 py-8 max-w-7xl">
        <header class="text-center mb-12">
            <h1 class="text-4xl font-bold text-indigo-700 mb-2">LAN Game Vote</h1>
            <p class="text-gray-600 max-w-2xl mx-auto">Vote for the games you'd like to play at the LAN party! Select "Interested" for games you want to play, "Maybe" for games you're open to, or "Not Interested" for games you'd rather avoid.</p>
            <p class="text-gray-600 max-w-2xl mx-auto">Make sure to click "Submit" at the bottom to save your votes!</p>
        </header>

        <div id="notification" class="hidden fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg">
            Vote submitted successfully!
        </div>

        <form id="voteForm" class="w-full">
            <div class="mb-8 bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Your Information</h2>
                <div class="form-group">
                    <label for="userName" class="form-label">Your Name <span class="text-red-500">*</span></label>
                    <input type="text" id="userName" name="userName" required
                           class="form-input"
                           placeholder="Enter your name">
                    <p class="text-sm text-gray-500 mt-1">This will be displayed with your votes</p>
                </div>
            </div>
            
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">Vote for Games</h2>
                <p class="text-gray-600 mb-6">Select your interest level for each game:</p>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                {% for game in games %}
                <div class="game-card bg-white rounded-xl shadow-sm overflow-hidden border border-gray-100">
                    <div class="card-content p-5">
                        <div>
                            <h3 class="game-title">
                                <a href="{{ game.url }}" target="_blank" class="hover:underline hover:text-indigo-600 transition-colors">
                                    {{ game.title }}
                                </a>
                            </h3>
                            <p class="game-meta">
                                {{ game.price }} â€¢ {{ game.max_players }} players
                            </p>
                            
                            <!-- Game Media -->
                            <div class="video-container aspect-ratio-box relative group">
                                {% if game.youtube_id %}
                                    {% set steam_app_id = game.url.split('/app/')[1].split('/')[0] if 'steampowered.com/app/' in game.url else '' %}
                                    <div class="video-thumbnail-container w-full h-full relative">
                                        <img 
                                            src="https://img.youtube.com/vi/{{ game.youtube_id }}/maxresdefault.jpg" 
                                            alt="{{ game.title }} thumbnail"
                                            class="video-thumbnail w-full h-full object-cover"
                                            onerror="this.onerror=null; this.src='https://img.youtube.com/vi/{{ game.youtube_id }}/hqdefault.jpg'"
                                        >
                                        <div 
                                            class="play-thumbnail absolute inset-0 flex items-center justify-center cursor-pointer bg-black bg-opacity-30 hover:bg-opacity-40 transition-all duration-200"
                                            data-video-id="{{ game.youtube_id }}"
                                            data-steam-app-id="{{ steam_app_id }}"
                                        >
                                            <div class="play-icon bg-black bg-opacity-70 hover:bg-red-600 w-16 h-16 rounded-full flex items-center justify-center transition-all duration-200 transform hover:scale-110">
                                                <svg class="w-8 h-8 text-white" viewBox="0 0 24 24" fill="currentColor">
                                                    <path d="M8 5v14l11-7z"></path>
                                                </svg>
                                            </div>
                                        </div>
                                    </div>
                                {% elif 'steam' in game.url %}
                                    <!-- Steam Game Cover with Play Button -->
                                    {% set app_id = game.url.split('/app/')[1].split('/')[0] %}
                                    <div class="aspect-ratio-box relative group">
                                        <img 
                                            src="https://steamcdn-a.akamaihd.net/steam/apps/{{ app_id }}/header.jpg" 
                                            alt="{{ game.title }} thumbnail" 
                                            class="w-full h-full object-cover"
                                            onerror="this.onerror=null; this.src='https://via.placeholder.com/600x300/1a202c/ffffff?text=No+Image'; this.className='w-full h-full object-contain p-4 bg-gray-100'"
                                        >
                                        <div 
                                            class="play-thumbnail absolute inset-0 flex items-center justify-center cursor-pointer bg-black bg-opacity-30 hover:bg-opacity-40 transition-all duration-200"
                                            data-steam-app-id="{{ app_id }}"
                                            {% if game.youtube_id %}
                                                data-video-id="{{ game.youtube_id }}"
                                            {% endif %}
                                        >
                                            <div class="play-icon bg-black bg-opacity-70 hover:bg-red-600 w-16 h-16 rounded-full flex items-center justify-center transition-all duration-200 transform hover:scale-110">
                                                <svg class="w-8 h-8 text-white" viewBox="0 0 24 24" fill="currentColor">
                                                    <path d="M8 5v14l11-7z"></path>
                                                </svg>
                                            </div>
                                        </div>
                                    </div>
                                {% else %}
                                    <!-- Fallback for games without video -->
                                    <div class="no-video-placeholder">
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z" />
                                        </svg>
                                        <p class="text-sm text-gray-600">{{ game.title }}</p>
                                        <a href="{{ game.url }}" target="_blank" class="text-indigo-600 hover:underline text-sm mt-1 inline-block">View on Store</a>
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                        
                        <!-- Voting Options -->
                        <div class="vote-options">
                            <label class="vote-option" data-vote="interested">
                                <input type="radio" name="{{ game.id }}" value="interested">
                                <span>Interested</span>
                            </label>
                            <label class="vote-option" data-vote="maybe">
                                <input type="radio" name="{{ game.id }}" value="maybe">
                                <span>Maybe</span>
                            </label>
                            <label class="vote-option" data-vote="not-interested">
                                <input type="radio" name="{{ game.id }}" value="not-interested">
                                <span>Not Interested</span>
                            </label>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>

            <div class="mt-12 text-center">
                <button type="submit" class="submit-btn">
                    Submit Your Votes
                </button>
                <div>
                    <a href="/results" class="results-link">
                        View Current Results
                    </a>
                </div>
            </div>
        </form>
    </div>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
